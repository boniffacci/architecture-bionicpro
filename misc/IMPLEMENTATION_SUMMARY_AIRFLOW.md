# ะะตะทัะผะต ัะตะฐะปะธะทะฐัะธะธ ะธะฝัะตะณัะฐัะธะธ Apache Airflow

## ะัะฟะพะปะฝะตะฝะฝัะต ะทะฐะดะฐัะธ

### 1. โ ะะฑะฝะพะฒะปะตะฝะธะต `import_olap_data.py`

**ะะทะผะตะฝะตะฝะธั ะฒ ััะตะผะต ัะฐะฑะปะธั ClickHouse (ััะตะผะฐ `default`):**

- **`users`**: ะธะทะผะตะฝัะฝ engine ั `Join(ANY, LEFT, user_uuid)` ะฝะฐ `ReplacingMergeTree() ORDER BY user_uuid`
- **`telemetry_events`**: ะธะทะผะตะฝัะฝ engine ั `MergeTree()` ะฝะฐ `ReplacingMergeTree(saved_ts) ORDER BY (event_uuid, user_uuid, created_ts)`

ะญัะธ ะธะทะผะตะฝะตะฝะธั ะพะฑะตัะฟะตัะธะฒะฐัั ัะพะณะปะฐัะพะฒะฐะฝะฝะพััั ััะตะผั `default` ัะพ ััะตะผะพะน `debezium`, ะบะพัะพัะฐั ะธัะฟะพะปัะทัะตััั ะดะปั real-time CDC ัะตัะตะท Kafka.

**ะะทะผะตะฝะตะฝะธะต start_date DAG:**

- ะฃััะฐะฝะพะฒะปะตะฝ `start_date=datetime(2025, 1, 1, tzinfo=timezone.utc)` (1 ัะฝะฒะฐัั 2025 ะณะพะดะฐ)
- ะะบะปัััะฝ `catchup=True` ะดะปั ะทะฐะณััะทะบะธ ะธััะพัะธัะตัะบะธั ะดะฐะฝะฝัั ะทะฐ ะฒัะต ะผะตัััั 2025 ะณะพะดะฐ

### 2. โ ะะพะฑะฐะฒะปะตะฝะธะต Apache Airflow 3.1.3 ะฒ `docker-compose.yaml`

**ะะพะฑะฐะฒะปะตะฝั ัะปะตะดัััะธะต ัะตัะฒะธัั:**

1. **`airflow-db`** - PostgreSQL 17 ะดะปั ะผะตัะฐะดะฐะฝะฝัั Airflow
   - ะะพัั: 5446
   - ะะ: `airflow_db`
   - ะะพะปัะทะพะฒะฐัะตะปั: `airflow_user` / `airflow_password`

2. **`airflow-webserver`** - ะะตะฑ-ะธะฝัะตััะตะนั Airflow
   - ะะพัั: 8082
   - ะะฐััะพะผะฝัะน Dockerfile ั ัััะฐะฝะพะฒะบะพะน ะทะฐะฒะธัะธะผะพััะตะน
   - ะะพะฝัะธัััััั ะฟะฐะฟะบะธ: `./dags`, `./crm_api`, `./telemetry_api`
   - ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะดะปั ะฟะพะดะบะปััะตะฝะธั ะบ ะะ (CRM, Telemetry, ClickHouse)

3. **`airflow-scheduler`** - ะะปะฐะฝะธัะพะฒัะธะบ DAG'ะพะฒ
   - ะขะต ะถะต ะทะฐะฒะธัะธะผะพััะธ ะธ volumes, ััะพ ั webserver
   - ะะฐะฟััะบะฐะตััั ะฟะพัะปะต ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ะะ

4. **`airflow-init`** - ะะฝะธัะธะฐะปะธะทะฐัะธั ะะ ะธ ัะพะทะดะฐะฝะธะต ะฐะดะผะธะฝะธัััะฐัะพัะฐ
   - ะัะฟะพะปะฝัะตั `airflow db migrate`
   - ะกะพะทะดะฐัั ะฟะพะปัะทะพะฒะฐัะตะปั `airflow_admin` ั ะฟะฐัะพะปะตะผ `airflow_password`
   - ะัะฟะพะปัะทัะตั ัะบัะธะฟั `./airflow/init_airflow.sh`

**ะกะพะทะดะฐะฝะฝัะต ัะฐะนะปั:**

- `./airflow/Dockerfile` - ะพะฑัะฐะท ั Python-ะทะฐะฒะธัะธะผะพัััะผะธ (clickhouse-connect, sqlmodel, psycopg2-binary, python-dateutil)
- `./airflow/init_airflow.sh` - ัะบัะธะฟั ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ั ะพะถะธะดะฐะฝะธะตะผ ะณะพัะพะฒะฝะพััะธ ะะ

**ะัะพะฑะตะฝะฝะพััะธ ะบะพะฝัะธะณััะฐัะธะธ:**

- Executor: `LocalExecutor` (ะดะปั ะพะดะฝะพะณะพ ัะทะปะฐ)
- ะัะธะผะตัั DAG'ะพะฒ ะพัะบะปััะตะฝั: `AIRFLOW__CORE__LOAD_EXAMPLES=false`
- DAG'ะธ ะฟะพ ัะผะพะปัะฐะฝะธั ะฟะฐัะทะธัะพะฒะฐะฝั: `AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=true`
- Fernet Key ะดะปั ัะธััะพะฒะฐะฝะธั: `ZmDfcTF7_60GrrY167zsiPd67pEvs0aGOv2oasOM1Pg=`

### 3. โ ะกะพะทะดะฐะฝะธะต ะธะฝัะตะณัะฐัะธะพะฝะฝะพะณะพ ัะตััะฐ `test_airflow_integration.py`

**ะงัะพ ัะตััะธััะตััั:**

1. `docker compose down -v` - ะพััะฐะฝะพะฒะบะฐ ะธ ัะดะฐะปะตะฝะธะต ะบะพะฝัะตะนะฝะตัะพะฒ/volumes
2. `docker compose build` - ัะฑะพัะบะฐ ะพะฑัะฐะทะพะฒ
3. `docker compose up -d` - ะทะฐะฟััะบ ะฒัะตั ัะตัะฒะธัะพะฒ
4. ะัะพะฒะตัะบะฐ ะณะพัะพะฒะฝะพััะธ ะฒัะตั ะพะฑัะทะฐัะตะปัะฝัั ะบะพะฝัะตะนะฝะตัะพะฒ (healthcheck)
5. ะะพะดะบะปััะตะฝะธะต ะบ Airflow REST API (http://localhost:8082/api/v1)
6. ะะฐะปะธัะธะต DAG `import_olap_data_monthly`
7. ะะตะฝะตัะฐัะธั ะดะฐะฝะฝัั ัะตัะตะท `/populate_base` ั `crm_api` ะธ `telemetry_api`
8. ะะบัะธะฒะฐัะธั DAG (ัะฝััะธะต ะฟะฐัะทั ัะตัะตะท REST API)
9. ะะถะธะดะฐะฝะธะต ัะพะทะดะฐะฝะธั Task Instances ะทะฐ ะฝะตัะบะพะปัะบะพ ะผะตัััะตะฒ 2025 ะณะพะดะฐ
10. ะะถะธะดะฐะฝะธะต ััะฟะตัะฝะพะณะพ ะฒัะฟะพะปะฝะตะฝะธั Task Instances (ะผะฐะบัะธะผัะผ 10 ะผะธะฝัั)
11. ะัะพะฒะตัะบะฐ ะดะฐะฝะฝัั ะฒ ClickHouse:
    - `default.users`: >= 1000 ะฟะพะปัะทะพะฒะฐัะตะปะตะน
    - `default.telemetry_events`: >= 10000 ัะพะฑััะธะน

**ะะฐัะฟะพะปะพะถะตะฝะธะต:** `./tests/test_airflow_integration.py`

**ะะฐะฟััะบ:**
```bash
.venv/bin/python tests/test_airflow_integration.py
```

### 4. โ ะะฑะฝะพะฒะปะตะฝะธะต ััะพะฝัะตะฝะดะฐ (`bionicpro_frontend/src/App.tsx`)

**ะะพะฑะฐะฒะปะตะฝ ะฝะพะฒัะน ะฑะปะพะบ "ETL-ะพะฟะตัะฐัะธะธ" ั ะดะฒัะผั ะบะฝะพะฟะบะฐะผะธ:**

#### ะะฝะพะฟะบะฐ 1: "ะกะณะตะฝะตัะธัะพะฒะฐัั ัะทะตัะพะฒ ะธ ัะพะฑััะธั"
- ะัะทัะฒะฐะตั `POST http://localhost:3001/populate_base` (CRM API)
- ะัะทัะฒะฐะตั `POST http://localhost:3002/populate_base` (Telemetry API)
- ะัะพะฑัะฐะถะฐะตั ัะตะทัะปััะฐั: ะบะพะปะธัะตััะฒะพ ัะพะทะดะฐะฝะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะธ ัะพะฑััะธะน

#### ะะฝะพะฟะบะฐ 2: "ะะฐะฟัััะธัั ETL-ะฟัะพัะตัั"
- ะะพะดะบะปััะฐะตััั ะบ Airflow REST API ั Basic Auth (`airflow_admin` / `airflow_password`)
- ะกะฝะธะผะฐะตั ะฟะฐัะทั ั DAG `import_olap_data_monthly` (PATCH ะทะฐะฟัะพั)
- ะขัะธะณะณะตัะธั ะฝะพะฒัะน DAG Run (POST ะทะฐะฟัะพั)
- ะัะบััะฒะฐะตั Airflow UI ะฒ ะฝะพะฒะพะน ะฒะบะปะฐะดะบะต (http://localhost:8082)
- ะัะพะฑัะฐะถะฐะตั ัะตะทัะปััะฐั ะทะฐะฟััะบะฐ

**ะะพะฑะฐะฒะปะตะฝ ะฟัะธะทะฝะฐะบ ะบััะฐ ะฒ ะพััััะฐั:**

ะ ะธะฝัะตััะตะนั ReportResponse ะดะพะฑะฐะฒะปะตะฝะพ ะฟะพะปะต:
```typescript
from_cache?: boolean  // ะัะธะทะฝะฐะบ, ััะพ ะพัััั ะฒะทัั ะธะท ะบััะฐ
```

ะ ะฑะปะพะบะต ะพัะพะฑัะฐะถะตะฝะธั ะพััััะฐ ะดะพะฑะฐะฒะปะตะฝะฐ ัััะพะบะฐ "ะััะพัะฝะธะบ":
- ๐ฆ **ะะท ะบััะฐ** (ะตัะปะธ `from_cache === true`)
- ๐ **ะะต ะธะท ะบััะฐ** (ะตัะปะธ `from_cache === false` ะธะปะธ `undefined`)

### 5. โ ะกะพะทะดะฐะฝะธะต Playwright-ัะตััะฐ `test_frontend_etl.py`

**ะงัะพ ัะตััะธััะตััั:**

1. ะัะบัััะธะต ััะพะฝัะตะฝะดะฐ ะธ ะฐะฒัะพัะธะทะฐัะธั ะฒ Keycloak (ะตัะปะธ ะฝะตะพะฑัะพะดะธะผะพ)
2. ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะฑะปะพะบะฐ "ETL-ะพะฟะตัะฐัะธะธ"
3. ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะบะฝะพะฟะพะบ "ะกะณะตะฝะตัะธัะพะฒะฐัั ัะทะตัะพะฒ ะธ ัะพะฑััะธั" ะธ "ะะฐะฟัััะธัั ETL-ะฟัะพัะตัั"
4. ะะฐะถะฐัะธะต ะบะฝะพะฟะบะธ "ะกะณะตะฝะตัะธัะพะฒะฐัั ัะทะตัะพะฒ ะธ ัะพะฑััะธั":
   - ะัะพะฒะตัะบะฐ ะฟะตัะตัะพะดะฐ ะบะฝะพะฟะบะธ ะฒ ัะพััะพัะฝะธะต "ะะตะฝะตัะฐัะธั..."
   - ะะถะธะดะฐะฝะธะต ััะฟะตัะฝะพะณะพ ะทะฐะฒะตััะตะฝะธั (ะผะฐะบัะธะผัะผ 60 ัะตะบัะฝะด)
   - ะัะพะฒะตัะบะฐ ัะตะทัะปััะฐัะฐ (ะบะพะปะธัะตััะฒะพ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะธ ัะพะฑััะธะน)
5. ะะฐะถะฐัะธะต ะบะฝะพะฟะบะธ "ะะฐะฟัััะธัั ETL-ะฟัะพัะตัั":
   - ะัะพะฒะตัะบะฐ ััะฟะตัะฝะพะณะพ ะทะฐะฟััะบะฐ
   - ะัะพะฒะตัะบะฐ ะพัะบัััะธั ะฝะพะฒะพะณะพ ะพะบะฝะฐ ั Airflow UI
6. ะัะพะฒะตัะบะฐ ะฟัะธะทะฝะฐะบะฐ ะบััะฐ ะฒ ะพััััะฐั:
   - ะะฐะฟัะพั ะพััััะฐ (ะฟะตัะฒัะน ัะฐะท - ะพะฑััะฝะพ ะฝะต ะธะท ะบััะฐ)
   - ะะพะฒัะพัะฝัะน ะทะฐะฟัะพั (ะพะฑััะฝะพ ะธะท ะบััะฐ)
   - ะัะพะฒะตัะบะฐ ะพัะพะฑัะฐะถะตะฝะธั ะผะตัะบะธ "ะััะพัะฝะธะบ"

**ะะฐัะฟะพะปะพะถะตะฝะธะต:** `./tests/test_frontend_etl.py`

**ะะฐะฟััะบ:**
```bash
.venv/bin/python -m pytest tests/test_frontend_etl.py -v -s
```

### 6. โ ะะพะบัะผะตะฝัะฐัะธั

ะกะพะทะดะฐะฝ ัะฐะนะป `AIRFLOW_ETL_README.md` ั ะฟะพะดัะพะฑะฝัะผ ััะบะพะฒะพะดััะฒะพะผ ะฟะพ:
- ะััะธัะตะบัััะต ัะธััะตะผั
- ะฃัััะฝัะผ ะดะฐะฝะฝัะผ
- ะะฐะฟััะบั ะธ ะฝะฐัััะพะนะบะต
- ะัะฟะพะปัะทะพะฒะฐะฝะธั ััะพะฝัะตะฝะดะฐ
- ะัะพะฒะตัะบะต ะดะฐะฝะฝัั ะฒ ClickHouse
- ะขะตััะธัะพะฒะฐะฝะธั
- Troubleshooting

## ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะกัะตะผั ัะฐะฑะปะธั ClickHouse

#### default.users (OLAP)
```sql
CREATE TABLE default.users (
    user_id Int32,
    user_uuid String,
    name String,
    email String,
    age Nullable(Int32),
    gender Nullable(String),
    country Nullable(String),
    address Nullable(String),
    phone Nullable(String),
    registered_at DateTime
) ENGINE = ReplacingMergeTree()
ORDER BY user_uuid
```

#### default.telemetry_events (OLAP)
```sql
CREATE TABLE default.telemetry_events (
    id Int64,
    event_uuid String,
    user_uuid String,
    prosthesis_type String,
    muscle_group String,
    signal_frequency Int32,
    signal_duration Int32,
    signal_amplitude Float64,
    created_ts DateTime,
    saved_ts DateTime
) ENGINE = ReplacingMergeTree(saved_ts)
PARTITION BY (toYear(created_ts), toMonth(created_ts))
ORDER BY (event_uuid, user_uuid, created_ts)
```

### ะะฐะฒะธัะธะผะพััะธ Airflow DAG

DAG `import_olap_data.py` ะธัะฟะพะปัะทัะตั ัะปะตะดัััะธะต ะฑะธะฑะปะธะพัะตะบะธ:
- `clickhouse-connect==0.7.19` - ะดะปั ะฟะพะดะบะปััะตะฝะธั ะบ ClickHouse
- `sqlmodel==0.0.22` - ะดะปั ัะฐะฑะพัั ั PostgreSQL ัะตัะตะท ORM
- `psycopg2-binary==2.9.9` - ะดัะฐะนะฒะตั PostgreSQL
- `python-dateutil==2.9.0` - ะดะปั ัะฐะฑะพัั ั ะดะฐัะฐะผะธ

ะญัะธ ะทะฐะฒะธัะธะผะพััะธ ัััะฐะฝะฐะฒะปะธะฒะฐัััั ะฒ ะบะฐััะพะผะฝะพะผ Dockerfile ะดะปั Airflow.

### REST API Airflow

ะัะฟะพะปัะทััััั ัะปะตะดัััะธะต ัะฝะดะฟะพะธะฝัั:
- `GET /api/v1/dags/{dag_id}` - ะฟะพะปััะตะฝะธะต ะธะฝัะพัะผะฐัะธะธ ะพ DAG
- `PATCH /api/v1/dags/{dag_id}` - ะธะทะผะตะฝะตะฝะธะต ะฟะฐัะฐะผะตััะพะฒ DAG (ะฝะฐะฟัะธะผะตั, ัะฝััะธะต ะฟะฐัะทั)
- `POST /api/v1/dags/{dag_id}/dagRuns` - ััะธะณะณะตั ะฝะพะฒะพะณะพ DAG Run
- `GET /api/v1/dags/{dag_id}/dagRuns` - ะฟะพะปััะตะฝะธะต ัะฟะธัะบะฐ DAG Runs
- `GET /api/v1/dags/{dag_id}/dagRuns/{dag_run_id}/taskInstances` - ะฟะพะปััะตะฝะธะต Task Instances

ะััะตะฝัะธัะธะบะฐัะธั: Basic Auth ั `airflow_admin` / `airflow_password`

## ะััะธัะตะบัััะฐ ะฟะพัะพะบะพะฒ ะดะฐะฝะฝัั

```
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
โ   CRM DB    โโโโโโถโ import_olap_ โ
โ (PostgreSQL)โ     โ data_monthly โ
โโโโโโโโโโโโโโโ     โ    (DAG)     โ
                    โโโโโโโโฌโโโโโโโโ
โโโโโโโโโโโโโโโ            โ
โ Telemetry DBโโโโโโโโโโโโโโ
โ (PostgreSQL)โ            โ
โโโโโโโโโโโโโโโ            โผ
                    โโโโโโโโโโโโโโโโ
                    โ  ClickHouse  โ
                    โ   default.*  โ
                    โโโโโโโโโโโโโโโโ
                           โ
                           โผ
                    โโโโโโโโโโโโโโโโ
                    โ Reports API  โโโโโ ะะพะปัะทะพะฒะฐัะตะปั
                    โโโโโโโโโโโโโโโโ
                           โ
                           โผ
                    โโโโโโโโโโโโโโโโ
                    โ    MinIO     โ (ะบัั ะพััััะพะฒ)
                    โโโโโโโโโโโโโโโโ
```

Real-time CDC ะฟะพัะพะบ (ะฟะฐัะฐะปะปะตะปัะฝะพ):
```
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
โ   CRM DB    โโโโโโถโ  Kafka   โโโโโโถโ  ClickHouse  โ
โ (PostgreSQL)โ     โ (topics) โ     โ  debezium.*  โ
โโโโโโโโโโโโโโโ     โโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
                         โฒ
โโโโโโโโโโโโโโโ          โ
โ Telemetry DBโโโโโโโโโโโโ
โ (PostgreSQL)โ
โโโโโโโโโโโโโโโ
```

## ะะพััั ัะตัะฒะธัะพะฒ

| ะกะตัะฒะธั              | ะะพัั  | ะะฟะธัะฐะฝะธะต                        |
|---------------------|-------|---------------------------------|
| Airflow Webserver   | 8082  | ะะตะฑ-ะธะฝัะตััะตะนั Airflow          |
| Airflow DB          | 5446  | PostgreSQL ะดะปั ะผะตัะฐะดะฐะฝะฝัั      |
| ClickHouse HTTP     | 8123  | HTTP API ะดะปั ะทะฐะฟัะพัะพะฒ          |
| ClickHouse Native   | 9431  | Native ะฟัะพัะพะบะพะป                |
| CRM API             | 3001  | REST API ะดะปั CRM               |
| Telemetry API       | 3002  | REST API ะดะปั ัะตะปะตะผะตััะธะธ        |
| Reports API         | 3003  | REST API ะดะปั ะพััััะพะฒ           |
| Frontend (auth_proxy)| 3000 | ะคัะพะฝัะตะฝะด ั ะฐะฒัะพัะธะทะฐัะธะตะน        |
| Keycloak            | 8080  | ะกะตัะฒะตั ะฐะฒัะพัะธะทะฐัะธะธ             |
| Kafka               | 9092  | ะัะพะบะตั ัะพะพะฑัะตะฝะธะน (external)    |
| Kafka UI            | 8084  | ะะตะฑ-ะธะฝัะตััะตะนั Kafka            |
| Debezium            | 8083  | REST API ะดะปั ัะฟัะฐะฒะปะตะฝะธั CDC    |
| Debezium UI         | 8088  | ะะตะฑ-ะธะฝัะตััะตะนั Debezium         |
| MinIO               | 9000  | S3-ัะพะฒะผะตััะธะผะพะต ััะฐะฝะธะปะธัะต       |
| MinIO Console       | 9001  | ะะตะฑ-ะธะฝัะตััะตะนั MinIO            |

## ะกัะฐััั ะฒัะฟะพะปะฝะตะฝะธั

โ ะัะต ะทะฐะดะฐัะธ ะฒัะฟะพะปะฝะตะฝั:
1. โ ะัะพะฒะตัะตะฝะฐ ะธ ะพะฑะฝะพะฒะปะตะฝะฐ ััะตะผะฐ ัะฐะฑะปะธั ะฒ `import_olap_data.py`
2. โ ะฃััะฐะฝะพะฒะปะตะฝ `start_date` ะฝะฐ 1 ัะฝะฒะฐัั 2025 ะณะพะดะฐ
3. โ ะะพะฑะฐะฒะปะตะฝ Airflow 3.1.3 ะฒ `docker-compose.yaml`
4. โ ะกะพะทะดะฐะฝ ะธะฝัะตะณัะฐัะธะพะฝะฝัะน ัะตัั `test_airflow_integration.py`
5. โ ะะฑะฝะพะฒะปัะฝ ััะพะฝัะตะฝะด: ะดะพะฑะฐะฒะปะตะฝ ะฑะปะพะบ ั ะบะฝะพะฟะบะฐะผะธ ETL
6. โ ะะฑะฝะพะฒะปัะฝ ััะพะฝัะตะฝะด: ะดะพะฑะฐะฒะปะตะฝะพ ะพัะพะฑัะฐะถะตะฝะธะต ะฟัะธะทะฝะฐะบะฐ ะบััะฐ
7. โ ะกะพะทะดะฐะฝ Playwright-ัะตัั `test_frontend_etl.py`
8. ๐ ะะฐะฟััะตะฝั ัะตััั ะดะปั ะฟัะพะฒะตัะบะธ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ

## ะกะปะตะดัััะธะต ัะฐะณะธ

1. ะะพะถะดะฐัััั ะทะฐะฒะตััะตะฝะธั ะธะฝัะตะณัะฐัะธะพะฝะฝะพะณะพ ัะตััะฐ
2. ะัะฟัะฐะฒะธัั ะฒะพะทะผะพะถะฝัะต ะฟัะพะฑะปะตะผั, ะฒััะฒะปะตะฝะฝัะต ัะตััะฐะผะธ
3. ะะฐะฟัััะธัั Playwright-ัะตัั ะดะปั ะฟัะพะฒะตัะบะธ ััะพะฝัะตะฝะดะฐ
4. ะัะพะฒะตััะธ ัะธะฝะฐะปัะฝัั ะฟัะพะฒะตัะบั ะฒัะตั ะบะพะผะฟะพะฝะตะฝัะพะฒ

## ะะทะฒะตััะฝัะต ะฟัะพะฑะปะตะผั

### ะะพะฝัะปะธะบั ะทะฐะฒะธัะธะผะพััะตะน ะฒ Airflow

ะัะธ ัะฑะพัะบะต ะพะฑัะฐะทะฐ Airflow ะฒะพะทะฝะธะบะฐะตั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต:
```
apache-airflow-providers-fab 3.0.1 requires sqlalchemy<2; python_version < "3.13", 
but you have sqlalchemy 2.0.44 which is incompatible.
```

ะญัะพ ะฝะต ะบัะธัะธัะฝะพ, ั.ะบ.:
- SQLAlchemy 2.0 ะพะฑัะฐัะฝะพ ัะพะฒะผะตััะธะผ ั 1.x API
- DAG `import_olap_data.py` ะธัะฟะพะปัะทัะตั `sqlmodel`, ะบะพัะพััะน ัะฐะฑะพัะฐะตั ั ะพะฑะตะธะผะธ ะฒะตััะธัะผะธ
- Airflow Webserver ะธ Scheduler ะฟัะพะดะพะปะถะฐัั ัะฐะฑะพัะฐัั ะฝะพัะผะฐะปัะฝะพ

ะัะปะธ ะฒะพะทะฝะธะบะฝัั ะฟัะพะฑะปะตะผั, ะผะพะถะฝะพ ะพัะบะฐัะธัััั ะฝะฐ SQLAlchemy 1.4.54.

# BionicPRO - Architecture & Security

> ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑƒÑ‡Ñ‘Ñ‚Ğ½Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹ PKCE

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ PKCE
./test-pkce.sh
```

## ğŸ“ Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ

### Task 1: ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¸ PKCE âœ…
**Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ:** [Task1/](./Task1/)

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:**
- ğŸ“Š [ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ](./Task1/README.md) - C4 Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ¸ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
- ğŸ“Š [PKCE Flow](./Task1/pkce-flow.puml) - Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
- ğŸ“– [PKCE Implementation](./Task1/PKCE_IMPLEMENTATION.md) - Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
- ğŸš€ [Quick Start](./Task1/QUICK_START.md) - Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºÑƒ
- ğŸ“ [Changes Summary](./Task1/CHANGES_SUMMARY.md) - Ğ ĞµĞ·ÑĞ¼Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
- ğŸ§ª [Test Script](./Task1/test-pkce.sh) - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

**Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾:**
- âœ… C4 Container Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹
- âœ… PKCE (S256) Ğ² Keycloak
- âœ… PKCE Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²Ğ¾ frontend
- âœ… ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

### Task 2: Reports Service (Java ETL & Analytics) âœ…
**Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ:** [Task2/](./Task2/)

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:**
- ğŸ“Š [ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Reports Service](./Task2/arch/bionicpro_reports_c4_container.puml) - C4 Container
- ğŸ“– [ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ](./Task2/README.md) - Java ETL, Reports API, Airflow
- ğŸ—„ï¸ [ClickHouse DDL](./Task2/olap/ddl/01_create_tables.sql) - Ğ¡Ñ…ĞµĞ¼Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- ğŸ [Airflow DAG](./Task2/airflow/dags/reports_etl_dag.py) - ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ETL

**Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾:**
- âœ… Java ETL (Spring Batch) Ğ´Ğ»Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ CRM Ğ¸ Ñ‚ĞµĞ»ĞµĞ¼ĞµÑ‚Ñ€Ğ¸Ğ¸
- âœ… Reports API (Spring Boot) Ñ OAuth2 Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ¾Ğ¹
- âœ… ClickHouse OLAP Ğ²Ğ¸Ñ‚Ñ€Ğ¸Ğ½Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- âœ… Apache Airflow Ğ´Ğ»Ñ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸
- âœ… Spring Security + Keycloak Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ
- âœ… Docker Compose Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²

### Task 3: _(Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ)_

## ğŸ”„ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
architecture-bionicpro/
â”œâ”€â”€ Task1/                          # âœ… Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 1 (PKCE Security)
â”‚   â”œâ”€â”€ diagram.puml               # C4 Container Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°
â”‚   â”œâ”€â”€ pkce-flow.puml             # PKCE Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
â”‚   â”œâ”€â”€ README.md                  # ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
â”‚   â”œâ”€â”€ PKCE_IMPLEMENTATION.md     # Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ PKCE
â”‚   â”œâ”€â”€ QUICK_START.md             # Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚
â”‚   â”œâ”€â”€ CHANGES_SUMMARY.md         # Ğ ĞµĞ·ÑĞ¼Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
â”‚   â””â”€â”€ test-pkce.sh               # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
â”œâ”€â”€ Task2/                          # âœ… Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 2 (Reports Service)
â”‚   â”œâ”€â”€ arch/                      # ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ñ‹Ğµ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹
â”‚   â”œâ”€â”€ etl-java/                  # Java ETL (Spring Batch)
â”‚   â”œâ”€â”€ reports-api/               # Reports API (Spring Boot)
â”‚   â”œâ”€â”€ airflow/                   # Airflow Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
â”‚   â”œâ”€â”€ olap/                      # ClickHouse DDL/seed
â”‚   â”œâ”€â”€ docker-compose.yml         # ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ÑÑ‚ĞµĞº ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
â”‚   â””â”€â”€ README.md                  # Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Task2
â”œâ”€â”€ Task3/                          # ğŸ”„ Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 3 (Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ)
â”œâ”€â”€ frontend/                       # React + PKCE
â”‚   â”œâ”€â”€ src/App.tsx                # PKCE ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
â”‚   â””â”€â”€ public/silent-check-sso.html
â”œâ”€â”€ keycloak/
â”‚   â””â”€â”€ realm-export.json          # PKCE Ğ²ĞºĞ»ÑÑ‡ĞµĞ½
â”œâ”€â”€ docker-compose.yaml             # Ğ˜Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° (Task1)
â”œâ”€â”€ test-pkce.sh                    # Wrapper Ğ´Ğ»Ñ Task1 ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ°
â””â”€â”€ README.md                       # Ğ­Ñ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ»
```

## ğŸ“Š Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹

| Ğ¡ĞµÑ€Ğ²Ğ¸Ñ | URL | Ğ£Ñ‡ĞµÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ |
|--------|-----|----------------|
| Frontend | http://localhost:3000 | - |
| Keycloak Admin | http://localhost:8080 | admin / admin |
| PostgreSQL | localhost:5433 | keycloak_user / keycloak_password |

## ğŸ› ï¸ Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸

- **Keycloak 21.1** - Identity Provider
- **React 18 + TypeScript** - Frontend  
- **Keycloak-JS** - PKCE Support
- **Docker Compose** - Ğ˜Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°
- **PlantUML** - Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ C4

## ğŸ“š ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ÑÑÑ‹Ğ»ĞºĞ¸

- [RFC 7636 - PKCE](https://datatracker.ietf.org/doc/html/rfc7636)
- [OAuth 2.1 Draft](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-09)
- [Keycloak Documentation](https://www.keycloak.org/documentation)
- [C4 Model](https://c4model.com/)

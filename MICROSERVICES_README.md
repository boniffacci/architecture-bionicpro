# –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã BionicPro

–î–≤–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã BionicPro: CRM API –∏ Telemetry API.

## –û–±–∑–æ—Ä

### CRM API
**–ü–æ—Ä—Ç:** 3002  
**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL (–ø–æ—Ä—Ç 5444)  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –±–∏–æ–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ç–µ–∑–æ–≤

### Telemetry API
**–ü–æ—Ä—Ç:** 3003  
**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL (–ø–æ—Ä—Ç 5445)  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–±–æ—Ä —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ —Å EMG-—Å–µ–Ω—Å–æ—Ä–æ–≤ –±–∏–æ–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ç–µ–∑–æ–≤

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd /home/felix/Projects/yandex_swa_pro/architecture-bionicpro
uv pip install -e .
```

### 2. –ó–∞–ø—É—Å–∫ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ó–∞–ø—É—Å–∫ –æ–±–µ–∏—Ö –ë–î
docker compose up -d crm_db telemetry_db

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker compose ps
```

### 3. –ó–∞–ø—É—Å–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ó–∞–ø—É—Å–∫ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö

**–¢–µ—Ä–º–∏–Ω–∞–ª 1 ‚Äî CRM API:**
```bash
uv run python crm_api/main.py
```

**–¢–µ—Ä–º–∏–Ω–∞–ª 2 ‚Äî Telemetry API:**
```bash
uv run python telemetry_api/main.py
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ

```bash
# CRM API
uv run python crm_api/main.py > crm_api.log 2>&1 &

# Telemetry API
uv run python telemetry_api/main.py > telemetry_api.log 2>&1 &
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# CRM API
curl http://localhost:3002/health

# Telemetry API
curl http://localhost:3003/health
```

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ —Ç–µ—Å—Ç—ã —Å—Ä–∞–∑—É
```bash
uv run pytest crm_api/test_crm_api.py telemetry_api/test_telemetry_api.py -v
```

### –¢–æ–ª—å–∫–æ CRM API
```bash
uv run pytest crm_api/test_crm_api.py -v
```

### –¢–æ–ª—å–∫–æ Telemetry API
```bash
uv run pytest telemetry_api/test_telemetry_api.py -v
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### CRM API ‚Äî –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
curl -X POST http://localhost:3002/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "G√©rard Kiko√Øne",
    "email": "gerard.kikoine@example.fr",
    "age": 75,
    "gender": "Male",
    "country": "France"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "id": 1,
  "name": "G√©rard Kiko√Øne",
  "email": "gerard.kikoine@example.fr",
  "age": 75,
  "gender": "Male",
  "country": "France",
  "address": null,
  "phone": null,
  "registered_at": "2025-11-18T11:30:00.000000Z"
}
```

### Telemetry API ‚Äî –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏

```bash
curl -X POST http://localhost:3003/telemetry \
  -H "Content-Type: application/json" \
  -d '{
    "events": [
      {
        "user_id": 512,
        "prosthesis_type": "arm",
        "muscle_group": "Biceps",
        "signal_frequency": 200,
        "signal_duration": 1000,
        "signal_amplitude": 3.5,
        "created_ts": "2025-01-01T12:00:00Z"
      }
    ]
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "user_id": 512,
    "prosthesis_type": "arm",
    "muscle_group": "Biceps",
    "signal_frequency": 200,
    "signal_duration": 1000,
    "signal_amplitude": 3.5,
    "signal_time": "2025-01-01T12:00:00Z",
    "saved_ts": "2025-11-18T11:30:00.000000Z"
  }
]
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
architecture-bionicpro/
‚îú‚îÄ‚îÄ crm_api/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # CRM API —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ test_crm_api.py         # –¢–µ—Å—Ç—ã CRM API
‚îÇ   ‚îú‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CRM API
‚îÇ   ‚îî‚îÄ‚îÄ crm-db/                 # –°–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
‚îÇ       ‚îú‚îÄ‚îÄ init.sql
‚îÇ       ‚îî‚îÄ‚îÄ crm.csv
‚îú‚îÄ‚îÄ telemetry_api/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # Telemetry API —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ test_telemetry_api.py   # –¢–µ—Å—Ç—ã Telemetry API
‚îÇ   ‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Telemetry API
‚îú‚îÄ‚îÄ docker-compose.yaml         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ pyproject.toml              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ MICROSERVICES_README.md     # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Python 3.12+**
- **FastAPI** ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **SQLModel** ‚Äî ORM (SQLAlchemy + Pydantic)
- **PostgreSQL 14** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **pytest** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **uv** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

### CRM DB
- **Host:** localhost
- **Port:** 5444
- **Database:** crm_db
- **User:** crm_user
- **Password:** crm_password

### Telemetry DB
- **Host:** localhost
- **Port:** 5445
- **Database:** telemetry_db
- **User:** telemetry_user
- **Password:** telemetry_password

## –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ API
```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep "crm_api\|telemetry_api"

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ PID
kill <PID>
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
docker compose stop crm_db telemetry_db

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º volumes (–æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö)
docker compose down -v crm_db telemetry_db
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### CRM API ‚Äî 8 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ñ–µ—Ä–∞—Ä–∞ –ö–∏–∫–æ–∏–Ω–∞
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ë—Ä–∏–¥–∂–∏—Ç –õ—è—ç
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –°–∏–ª—å–≤–∏–∏ –ë—É—Ä–¥–æ–Ω
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ê–ª—å–±–∞–Ω–∞ –°–µ—Ä–µ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ email
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

### Telemetry API ‚Äî 8 —Ç–µ—Å—Ç–æ–≤ ‚úÖ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞
- ‚úÖ –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –ø—Ä–æ—Ç–µ–∑–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ saved_ts
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ 100 —Å–æ–±—ã—Ç–∏–π

**–ò—Ç–æ–≥–æ: 16/16 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ** üéâ

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –û–±—â–∏–µ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **SQLModel** –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ –í—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ **UTC**
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ **–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **CORS**
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö SQL-–∑–∞–ø—Ä–æ—Å–æ–≤

### CRM API
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å email —Å –∏–Ω–¥–µ–∫—Å–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ registered_at
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

### Telemetry API
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –î–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—è (created_ts –∏ saved_ts)
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [CRM API README](crm_api/README.md) ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CRM API
- [Telemetry API README](telemetry_api/README.md) ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Telemetry API

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ë–î: `docker compose ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ë–î: `docker compose logs crm_db telemetry_db`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
